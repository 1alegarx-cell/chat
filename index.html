// Этот код должен быть ВНЕ функций, просто в теле скрипта
auth.getRedirectResult()
    .then((result) => {
        // Если в результате есть пользователь, значит мы только что вернулись от Google
        if (result && result.user) {
            console.log("Вход выполнен через Google:", result.user.displayName);
            localStorage.setItem('user_name', result.user.displayName);
            window.location.href = 'chat.html'; // Отправляем в чат
        }
    })
    .catch((error) => {
        console.error("Ошибка при возврате от Google:", error);
    });

// И на всякий случай добавим проверку: если пользователь уже вошел
auth.onAuthStateChanged((user) => {
    if (user) {
        localStorage.setItem('user_name', user.displayName);
        // window.location.href = 'chat.html'; // Раскомментируй это, если хочешь авто-вход
    }
});
